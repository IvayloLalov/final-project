{"ast":null,"code":"import { inject } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../api.service\";\nclass PermissionsService {\n  constructor(router, api) {\n    this.router = router;\n    this.api = api;\n    this.restaurant = {};\n  }\n  canActivate(next, state) {\n    const id = next.params['restaurantId'];\n    const userId = localStorage.getItem('userId');\n    // this.api.getRestaurant(id).pipe(\n    //   tap((restaurant) => {\n    //     this.restaurant = restaurant;\n    //   })\n    // );\n    this.api.getRestaurant(id).subscribe(restaurant => {\n      this.restaurant = restaurant;\n      localStorage.setItem('ownerId', restaurant._ownerId);\n    });\n    const ownerId = localStorage.getItem('ownerId');\n    const isOwner = ownerId === userId;\n    return !!isOwner;\n  }\n  static #_ = this.ɵfac = function PermissionsService_Factory(t) {\n    return new (t || PermissionsService)(i0.ɵɵinject(i1.Router), i0.ɵɵinject(i2.ApiService));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: PermissionsService,\n    factory: PermissionsService.ɵfac,\n    providedIn: 'root'\n  });\n}\nexport const IsOwnerGuard = (next, state) => {\n  return inject(PermissionsService).canActivate(next, state);\n};","map":{"version":3,"names":["inject","PermissionsService","constructor","router","api","restaurant","canActivate","next","state","id","params","userId","localStorage","getItem","getRestaurant","subscribe","setItem","_ownerId","ownerId","isOwner","_","i0","ɵɵinject","i1","Router","i2","ApiService","_2","factory","ɵfac","providedIn","IsOwnerGuard"],"sources":["D:\\SoftUni JS Angular\\Final Project\\final-project\\src\\app\\guards\\isOwner.guard.ts"],"sourcesContent":["import { Injectable, inject } from '@angular/core';\r\nimport {\r\n  Router,\r\n  ActivatedRouteSnapshot,\r\n  RouterStateSnapshot,\r\n  CanActivateFn,\r\n} from '@angular/router';\r\nimport { ApiService } from '../api.service';\r\n\r\nimport { Restaurant } from 'src/types/restaurant';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nclass PermissionsService {\r\n  constructor(private router: Router, private api: ApiService) {}\r\n  restaurant = {} as Restaurant;\r\n\r\n  canActivate(\r\n    next: ActivatedRouteSnapshot,\r\n    state: RouterStateSnapshot\r\n  ): boolean {\r\n    const id = next.params['restaurantId'];\r\n    const userId = localStorage.getItem('userId');\r\n\r\n    // this.api.getRestaurant(id).pipe(\r\n    //   tap((restaurant) => {\r\n    //     this.restaurant = restaurant;\r\n    //   })\r\n    // );\r\n\r\n    this.api.getRestaurant(id).subscribe((restaurant) => {\r\n      this.restaurant = restaurant;\r\n      localStorage.setItem('ownerId', restaurant._ownerId);\r\n    });\r\n\r\n    const ownerId = localStorage.getItem('ownerId');\r\n    const isOwner = ownerId === userId;\r\n\r\n    return !!isOwner;\r\n  }\r\n}\r\n\r\nexport const IsOwnerGuard: CanActivateFn = (\r\n  next: ActivatedRouteSnapshot,\r\n  state: RouterStateSnapshot\r\n): boolean => {\r\n  return inject(PermissionsService).canActivate(next, state);\r\n};\r\n"],"mappings":"AAAA,SAAqBA,MAAM,QAAQ,eAAe;;;;AAWlD,MAGMC,kBAAkB;EACtBC,YAAoBC,MAAc,EAAUC,GAAe;IAAvC,KAAAD,MAAM,GAANA,MAAM;IAAkB,KAAAC,GAAG,GAAHA,GAAG;IAC/C,KAAAC,UAAU,GAAG,EAAgB;EADiC;EAG9DC,WAAWA,CACTC,IAA4B,EAC5BC,KAA0B;IAE1B,MAAMC,EAAE,GAAGF,IAAI,CAACG,MAAM,CAAC,cAAc,CAAC;IACtC,MAAMC,MAAM,GAAGC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC;IAE7C;IACA;IACA;IACA;IACA;IAEA,IAAI,CAACT,GAAG,CAACU,aAAa,CAACL,EAAE,CAAC,CAACM,SAAS,CAAEV,UAAU,IAAI;MAClD,IAAI,CAACA,UAAU,GAAGA,UAAU;MAC5BO,YAAY,CAACI,OAAO,CAAC,SAAS,EAAEX,UAAU,CAACY,QAAQ,CAAC;IACtD,CAAC,CAAC;IAEF,MAAMC,OAAO,GAAGN,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;IAC/C,MAAMM,OAAO,GAAGD,OAAO,KAAKP,MAAM;IAElC,OAAO,CAAC,CAACQ,OAAO;EAClB;EAAC,QAAAC,CAAA,G;qBA1BGnB,kBAAkB,EAAAoB,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,MAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,UAAA;EAAA;EAAA,QAAAC,EAAA,G;WAAlB1B,kBAAkB;IAAA2B,OAAA,EAAlB3B,kBAAkB,CAAA4B,IAAA;IAAAC,UAAA,EAFV;EAAM;;AA+BpB,OAAO,MAAMC,YAAY,GAAkBA,CACzCxB,IAA4B,EAC5BC,KAA0B,KACf;EACX,OAAOR,MAAM,CAACC,kBAAkB,CAAC,CAACK,WAAW,CAACC,IAAI,EAAEC,KAAK,CAAC;AAC5D,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}